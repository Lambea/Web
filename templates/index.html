{% extends "layout.html" %}

{% block title %}ğŸ“… æˆ‘çš„è¡Œäº‹æ›†{% endblock %}

{% block content %}
<h1>ğŸ“… æˆ‘çš„è¡Œäº‹æ›†</h1>

<!-- ğŸ” æœå°‹ & ç¯©é¸ -->
<div style="max-width: 900px; margin: 10px auto; text-align: center;">
  <input type="text" id="searchInput" placeholder="ğŸ” æœå°‹æ¨™é¡Œæˆ–æ—¥è¨˜" style="padding:5px; width:200px;">
  <select id="tagFilter" style="padding:5px;">
    <option value="">å…¨éƒ¨æ¨™ç±¤</option>
    <option value="å·¥ä½œ">å·¥ä½œ</option>
    <option value="ç”Ÿæ´»">ç”Ÿæ´»</option>
    <option value="é‹å‹•">é‹å‹•</option>
  </select>
</div>

<!-- è¡Œäº‹æ›† -->
<div id="calendar"></div>

<!-- é¸æ“‡æ–°å¢å…§å®¹ Modal -->
<div id="chooseModal" class="modal">
  <h3>è«‹é¸æ“‡è¦æ–°å¢çš„å…§å®¹</h3>
  <button type="button" onclick="openEventModal()">â• æ–°å¢äº‹ä»¶</button>
  <button type="button" onclick="openDiaryModal()">ğŸ“– æ–°å¢æ—¥è¨˜</button>
  <button type="button" onclick="openImageModal()">ğŸ–¼ï¸ æ–°å¢åœ–ç‰‡</button>
  <button type="button" onclick="closeChooseModal()">å–æ¶ˆ</button>
</div>

<!-- æ–°å¢äº‹ä»¶ Modal -->
<div id="eventModal" class="modal">
  <h3>æ–°å¢äº‹ä»¶</h3>
  <form method="POST" action="/add_event" enctype="multipart/form-data">
    <input type="hidden" id="date_event" name="date">
    <label>æ¨™é¡Œ: <input type="text" name="title" required></label><br><br>
    <label>æ™‚é–“: <input type="time" name="time" required></label><br><br>
    <label>æ¨™ç±¤:
      <select name="tag">
        <option value="">ç„¡</option>
        <option value="å·¥ä½œ">å·¥ä½œ</option>
        <option value="ç”Ÿæ´»">ç”Ÿæ´»</option>
        <option value="é‹å‹•">é‹å‹•</option>
      </select>
    </label><br><br>
    <label>å¾ªç’°:
      <select name="repeat_rule">
        <option value="none">ä¸å¾ªç’°</option>
        <option value="daily">æ¯å¤©</option>
        <option value="weekly">æ¯é€±</option>
        <option value="monthly">æ¯æœˆ</option>
        <option value="every_3_days">æ¯ 3 å¤©</option>
      </select>
    </label><br><br>
    <label>é¡è‰²: <input type="color" name="color" value="#007bff"></label><br><br>
    <button type="submit">æ–°å¢</button>
    <button type="button" onclick="closeModal('eventModal')">å–æ¶ˆ</button>
  </form>
</div>

<!-- æ–°å¢æ—¥è¨˜ Modal -->
<div id="diaryModal" class="modal">
  <h3>æ–°å¢æ—¥è¨˜</h3>
  <form method="POST" action="/add_event" enctype="multipart/form-data">
    <input type="hidden" id="date_diary" name="date">
    <input type="hidden" name="time" value="00:00">
    <label>æ—¥è¨˜:<br>
      <textarea name="diary" rows="5" cols="40" required></textarea>
    </label><br><br>
    <button type="submit">æ–°å¢</button>
    <button type="button" onclick="closeModal('diaryModal')">å–æ¶ˆ</button>
  </form>
</div>

<!-- æ–°å¢åœ–ç‰‡ Modal -->
<div id="imageModal" class="modal">
  <h3>æ–°å¢åœ–ç‰‡</h3>
  <form method="POST" action="/add_event" enctype="multipart/form-data">
    <input type="hidden" id="date_image" name="date">
    <input type="hidden" name="time" value="00:00">
    <label>åœ–ç‰‡: <input type="file" name="image" required></label><br><br>
    <button type="submit">æ–°å¢</button>
    <button type="button" onclick="closeModal('imageModal')">å–æ¶ˆ</button>
  </form>
</div>

{% endblock %}

{% block scripts %}
<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<!-- Calendar.js -->
<script src="{{ url_for('static', filename='js/calendar.js') }}"></script>

<script>
  var selectedDate = null;
  function closeChooseModal() { document.getElementById("chooseModal").style.display = "none"; }
  function openEventModal() { closeChooseModal(); document.getElementById("eventModal").style.display = "block"; }
  function openDiaryModal() { closeChooseModal(); document.getElementById("diaryModal").style.display = "block"; }
  function openImageModal() { closeChooseModal(); document.getElementById("imageModal").style.display = "block"; }
  function closeModal(id) { document.getElementById(id).style.display = "none"; }
</script>
{% endblock %}
